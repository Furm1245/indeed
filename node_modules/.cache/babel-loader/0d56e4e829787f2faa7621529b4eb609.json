{"ast":null,"code":"import _slicedToArray from\"C:/Users/pures/projects/indeed/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import{useState,useCallback,useEffect}from'react';var logoutTimer;export var useAuth=function useAuth(){var _useState=useState(false),_useState2=_slicedToArray(_useState,2),token=_useState2[0],setToken=_useState2[1];var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),tokenExpirationDate=_useState4[0],setTokenExpirationDate=_useState4[1];var _useState5=useState(false),_useState6=_slicedToArray(_useState5,2),userId=_useState6[0],setUserId=_useState6[1];var login=useCallback(function(uid,token,expirationDate){setToken(token);setUserId(uid);var tokenExpirationDate=expirationDate||new Date(new Date().getTime()+1000*60*60);setTokenExpirationDate(tokenExpirationDate);localStorage.setItem('userData',JSON.stringify({userId:uid,token:token,expiration:tokenExpirationDate.toISOString()}));},[]);var logout=useCallback(function(){setToken(null);setTokenExpirationDate(null);setUserId(null);localStorage.removeItem('userData');},[]);useEffect(function(){if(token&&tokenExpirationDate){var remainingTime=tokenExpirationDate.getTime()-new Date().getTime();logoutTimer=setTimeout(logout,remainingTime);}else{clearTimeout(logoutTimer);}},[token,logout,tokenExpirationDate]);useEffect(function(){var storedData=JSON.parse(localStorage.getItem('userData'));if(storedData&&storedData.token&&new Date(storedData.expiration)>new Date()){login(storedData.userId,storedData.token,new Date(storedData.expiration));}},[login]);return{token:token,login:login,logout:logout,userId:userId};};","map":{"version":3,"sources":["C:/Users/pures/projects/indeed/src/shared/hooks/auth-hook.js"],"names":["useState","useCallback","useEffect","logoutTimer","useAuth","token","setToken","tokenExpirationDate","setTokenExpirationDate","userId","setUserId","login","uid","expirationDate","Date","getTime","localStorage","setItem","JSON","stringify","expiration","toISOString","logout","removeItem","remainingTime","setTimeout","clearTimeout","storedData","parse","getItem"],"mappings":"oHAAA,OAASA,QAAT,CAAmBC,WAAnB,CAAgCC,SAAhC,KAAiD,OAAjD,CAEA,GAAIC,CAAAA,WAAJ,CAEA,MAAO,IAAMC,CAAAA,OAAO,CAAG,QAAVA,CAAAA,OAAU,EAAM,CACzB,cAA0BJ,QAAQ,CAAC,KAAD,CAAlC,wCAAOK,KAAP,eAAcC,QAAd,eACA,eAAsDN,QAAQ,EAA9D,yCAAOO,mBAAP,eAA4BC,sBAA5B,eACA,eAA4BR,QAAQ,CAAC,KAAD,CAApC,yCAAOS,MAAP,eAAeC,SAAf,eAEA,GAAMC,CAAAA,KAAK,CAAGV,WAAW,CAAC,SAACW,GAAD,CAAMP,KAAN,CAAaQ,cAAb,CAAgC,CACtDP,QAAQ,CAACD,KAAD,CAAR,CACAK,SAAS,CAACE,GAAD,CAAT,CACA,GAAML,CAAAA,mBAAmB,CACrBM,cAAc,EAAI,GAAIC,CAAAA,IAAJ,CAAS,GAAIA,CAAAA,IAAJ,GAAWC,OAAX,GAAuB,KAAO,EAAP,CAAY,EAA5C,CADtB,CAEAP,sBAAsB,CAACD,mBAAD,CAAtB,CACAS,YAAY,CAACC,OAAb,CACI,UADJ,CAEIC,IAAI,CAACC,SAAL,CAAe,CACXV,MAAM,CAAEG,GADG,CAEXP,KAAK,CAAEA,KAFI,CAGXe,UAAU,CAAEb,mBAAmB,CAACc,WAApB,EAHD,CAAf,CAFJ,EAQH,CAdwB,CActB,EAdsB,CAAzB,CAgBA,GAAMC,CAAAA,MAAM,CAAGrB,WAAW,CAAC,UAAM,CAC7BK,QAAQ,CAAC,IAAD,CAAR,CACAE,sBAAsB,CAAC,IAAD,CAAtB,CACAE,SAAS,CAAC,IAAD,CAAT,CACAM,YAAY,CAACO,UAAb,CAAwB,UAAxB,EACH,CALyB,CAKvB,EALuB,CAA1B,CAOArB,SAAS,CAAC,UAAM,CACZ,GAAIG,KAAK,EAAIE,mBAAb,CAAkC,CAC9B,GAAMiB,CAAAA,aAAa,CAAGjB,mBAAmB,CAACQ,OAApB,GAAgC,GAAID,CAAAA,IAAJ,GAAWC,OAAX,EAAtD,CACAZ,WAAW,CAAGsB,UAAU,CAACH,MAAD,CAASE,aAAT,CAAxB,CACH,CAHD,IAGO,CACHE,YAAY,CAACvB,WAAD,CAAZ,CACH,CACJ,CAPQ,CAON,CAACE,KAAD,CAAQiB,MAAR,CAAgBf,mBAAhB,CAPM,CAAT,CASAL,SAAS,CAAC,UAAM,CACZ,GAAMyB,CAAAA,UAAU,CAAGT,IAAI,CAACU,KAAL,CAAWZ,YAAY,CAACa,OAAb,CAAqB,UAArB,CAAX,CAAnB,CACA,GACIF,UAAU,EACVA,UAAU,CAACtB,KADX,EAEA,GAAIS,CAAAA,IAAJ,CAASa,UAAU,CAACP,UAApB,EAAkC,GAAIN,CAAAA,IAAJ,EAHtC,CAIE,CACEH,KAAK,CAACgB,UAAU,CAAClB,MAAZ,CAAoBkB,UAAU,CAACtB,KAA/B,CAAsC,GAAIS,CAAAA,IAAJ,CAASa,UAAU,CAACP,UAApB,CAAtC,CAAL,CACH,CACJ,CATQ,CASN,CAACT,KAAD,CATM,CAAT,CAWA,MAAO,CAAEN,KAAK,CAALA,KAAF,CAASM,KAAK,CAALA,KAAT,CAAgBW,MAAM,CAANA,MAAhB,CAAwBb,MAAM,CAANA,MAAxB,CAAP,CACH,CAjDM","sourcesContent":["import { useState, useCallback, useEffect } from 'react';\r\n\r\nlet logoutTimer;\r\n\r\nexport const useAuth = () => {\r\n    const [token, setToken] = useState(false);\r\n    const [tokenExpirationDate, setTokenExpirationDate] = useState();\r\n    const [userId, setUserId] = useState(false);\r\n\r\n    const login = useCallback((uid, token, expirationDate) => {\r\n        setToken(token);\r\n        setUserId(uid);\r\n        const tokenExpirationDate =\r\n            expirationDate || new Date(new Date().getTime() + 1000 * 60 * 60);\r\n        setTokenExpirationDate(tokenExpirationDate);\r\n        localStorage.setItem(\r\n            'userData',\r\n            JSON.stringify({\r\n                userId: uid,\r\n                token: token,\r\n                expiration: tokenExpirationDate.toISOString()\r\n            })\r\n        );\r\n    }, []);\r\n\r\n    const logout = useCallback(() => {\r\n        setToken(null);\r\n        setTokenExpirationDate(null);\r\n        setUserId(null);\r\n        localStorage.removeItem('userData');\r\n    }, []);\r\n\r\n    useEffect(() => {\r\n        if (token && tokenExpirationDate) {\r\n            const remainingTime = tokenExpirationDate.getTime() - new Date().getTime();\r\n            logoutTimer = setTimeout(logout, remainingTime);\r\n        } else {\r\n            clearTimeout(logoutTimer);\r\n        }\r\n    }, [token, logout, tokenExpirationDate]);\r\n\r\n    useEffect(() => {\r\n        const storedData = JSON.parse(localStorage.getItem('userData'));\r\n        if (\r\n            storedData &&\r\n            storedData.token &&\r\n            new Date(storedData.expiration) > new Date()\r\n        ) {\r\n            login(storedData.userId, storedData.token, new Date(storedData.expiration));\r\n        }\r\n    }, [login]);\r\n\r\n    return { token, login, logout, userId };\r\n};"]},"metadata":{},"sourceType":"module"}