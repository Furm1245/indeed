{"ast":null,"code":"import _asyncToGenerator from\"C:/Users/pures/projects/indeed/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"C:/Users/pures/projects/indeed/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"C:\\\\Users\\\\pures\\\\projects\\\\indeed\\\\node_modules\\\\@babel\\\\runtime\\\\regenerator\\\\index.js\";import React,{useState,useEffect,useCallback}from\"react\";import{useParams}from'react-router-dom';import{Button,Modal}from'react-bootstrap';import{useContext}from\"react\";import{AuthContext}from'../../shared/context/auth-context';import{Link}from'react-router-dom';import classes from'./StartingPageContent.module.css';import Card from'./Card';import List from\"./List\";import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";var HomePage=function HomePage(){var auth=useContext(AuthContext);var _useState=useState(false),_useState2=_slicedToArray(_useState,2),show=_useState2[0],setShow=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),job=_useState4[0],setJob=_useState4[1];var _useState5=useState([]),_useState6=_slicedToArray(_useState5,2),info=_useState6[0],setInfo=_useState6[1];var _useState7=useState([]),_useState8=_slicedToArray(_useState7,2),user=_useState8[0],setUser=_useState8[1];var _useState9=useState(''),_useState10=_slicedToArray(_useState9,2),what=_useState10[0],setWhat=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),app=_useState12[0],setApp=_useState12[1];var jobId=useParams().id;var userId=auth.userId;var handleClose=function handleClose(){return setShow(false);};var handleShow=function handleShow(){return setShow(true);};useEffect(function(){var fetchjob=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var req,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"\".concat(process.env.REACT_APP_BACKEND_URLS,\"/jobs\"),{headers:{'Content-Type':'application/json'}});case 3:req=_context.sent;_context.next=6;return req.json();case 6:data=_context.sent;setJob(data.jobs);_context.next=13;break;case 10:_context.prev=10;_context.t0=_context[\"catch\"](0);console.log(_context.t0);case 13:case\"end\":return _context.stop();}}},_callee,null,[[0,10]]);}));return function fetchjob(){return _ref.apply(this,arguments);};}();fetchjob();filterJobs(what);},[]);useEffect(function(){var fetchInfo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var req,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"\".concat(process.env.REACT_APP_BACKEND_URLS,\"/job/\").concat(jobId),{method:'GET',headers:{'Content-Type':'application/json'}});case 3:req=_context2.sent;_context2.next=6;return req.json();case 6:data=_context2.sent;setInfo(data.job);if(req.ok){_context2.next=10;break;}throw new Error(req.message);case 10:_context2.next=14;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](0);case 14:case\"end\":return _context2.stop();}}},_callee2,null,[[0,12]]);}));return function fetchInfo(){return _ref2.apply(this,arguments);};}();fetchInfo();},[jobId]);var Apply=useCallback(/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var name,email,age,number,experience,req;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:name=user.name;email=user.email;age=user.age;number=user.number;experience=user.experience;_context3.prev=5;_context3.next=8;return fetch(\"\".concat(process.env.REACT_APP_BACKEND_URLS,\"/job/\").concat(jobId,\"/apply\"),{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({name:name,email:email,age:age,number:number,experience:experience})});case 8:req=_context3.sent;if(req.ok){alert('successfully Applied, may take time to save');}if(req.ok){_context3.next=13;break;}alert('something went wrong or you already applied');throw new Error(req.message);case 13:_context3.next=17;break;case 15:_context3.prev=15;_context3.t0=_context3[\"catch\"](5);case 17:case\"end\":return _context3.stop();}}},_callee3,null,[[5,15]]);})),[jobId,user.age,user.email,user.experience,user.name,user.number]);useEffect(function(){var fetchUser=/*#__PURE__*/function(){var _ref4=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var req,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;_context4.next=3;return fetch(\"\".concat(process.env.REACT_APP_BACKEND_URLS,\"/user/\").concat(userId),{method:'GET',headers:{'Content-Type':'application/json'}});case 3:req=_context4.sent;_context4.next=6;return req.json();case 6:data=_context4.sent;setUser(data.users);setApp(data.users.applied);if(req.ok){_context4.next=11;break;}throw new Error(req.message);case 11:_context4.next=15;break;case 13:_context4.prev=13;_context4.t0=_context4[\"catch\"](0);case 15:case\"end\":return _context4.stop();}}},_callee4,null,[[0,13]]);}));return function fetchUser(){return _ref4.apply(this,arguments);};}();fetchUser();},[userId,Apply]);var jobInfo=job.map(function(job){return/*#__PURE__*/_jsx(Card,{id:job.id,title:job.title,salary:job.salary,location:job.location,type:job.type,description:job.description},job.id);});var appInfo=app.map(function(_ref5){var title=_ref5.title,salary=_ref5.salary,location=_ref5.location;return/*#__PURE__*/_jsx(List,{title:title,salary:salary,location:location},Math.random());});var filterJobs=function filterJobs(what){var filteredData=[];for(var i=0;i<jobInfo.length;i++){what=what.toLowerCase();var name=jobInfo[i].props.title.toLowerCase();if(name.includes(what)){filteredData.push(jobInfo[i].props);setJob(filteredData);}}};var onFilter=function onFilter(){filterJobs(what);};return/*#__PURE__*/_jsxs(\"section\",{className:classes.background,children:[/*#__PURE__*/_jsxs(Modal,{show:show,onHide:handleClose,children:[/*#__PURE__*/_jsx(Modal.Header,{closeButton:true,children:/*#__PURE__*/_jsx(Modal.Title,{children:\"Applied To\"})}),/*#__PURE__*/_jsx(Modal.Body,{children:appInfo||'No jobs applied to'}),/*#__PURE__*/_jsx(Modal.Footer,{children:/*#__PURE__*/_jsx(Button,{variant:\"danger\",onClick:handleClose,children:\"Close\"})})]}),/*#__PURE__*/_jsx(\"div\",{className:classes.search,children:/*#__PURE__*/_jsx(\"form\",{children:/*#__PURE__*/_jsxs(\"div\",{className:classes.inside,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.filter,children:[/*#__PURE__*/_jsx(\"label\",{htmlFor:\"what\",children:\"What\"}),/*#__PURE__*/_jsx(\"input\",{id:\"What\",className:classes.inputs,value:what,onChange:function onChange(e){return setWhat(e.target.value);},placeholder:\"Job title or Keywords\"})]}),/*#__PURE__*/_jsx(\"div\",{children:/*#__PURE__*/_jsx(Button,{onClick:onFilter,children:\"Filter jobs\"})})]})})}),auth.isLoggedIn&&/*#__PURE__*/_jsx(\"div\",{className:classes.buttons,children:/*#__PURE__*/_jsx(Button,{onClick:handleShow,children:\"My Jobs\"})}),/*#__PURE__*/_jsxs(\"div\",{className:classes.cards,children:[/*#__PURE__*/_jsx(\"div\",{children:jobInfo}),/*#__PURE__*/_jsxs(\"div\",{className:classes.card2,children:[/*#__PURE__*/_jsxs(\"div\",{className:classes.sections,children:[/*#__PURE__*/_jsx(\"h3\",{children:info.title||'Select a job'}),/*#__PURE__*/_jsx(\"h5\",{children:info.location}),auth.isLoggedIn&&/*#__PURE__*/_jsx(Button,{onClick:Apply,children:\"Apply Now\"}),!auth.isLoggedIn&&/*#__PURE__*/_jsx(Link,{to:\"/auth\",children:/*#__PURE__*/_jsx(Button,{children:\"Apply Now\"})})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.sections,children:[/*#__PURE__*/_jsx(\"h3\",{children:\"Job Details\"}),/*#__PURE__*/_jsx(\"h6\",{children:\"Salary\"}),/*#__PURE__*/_jsx(\"p\",{children:info.salary||'Searching...'}),/*#__PURE__*/_jsx(\"h6\",{children:\"Job Type\"}),/*#__PURE__*/_jsx(\"p\",{children:info.type||'Searching...'})]}),/*#__PURE__*/_jsxs(\"div\",{className:classes.sections,children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Qualifications\"}),/*#__PURE__*/_jsx(\"p\",{children:info.qualifications||'Searching...'})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h2\",{children:\"Full Job Description\"}),/*#__PURE__*/_jsx(\"p\",{children:info.description||'Searching...'})]})]})]})]});};export default HomePage;","map":{"version":3,"sources":["C:/Users/pures/projects/indeed/src/components/StartingPage/StartingPageContent.js"],"names":["React","useState","useEffect","useCallback","useParams","Button","Modal","useContext","AuthContext","Link","classes","Card","List","HomePage","auth","show","setShow","job","setJob","info","setInfo","user","setUser","what","setWhat","app","setApp","jobId","id","userId","handleClose","handleShow","fetchjob","fetch","process","env","REACT_APP_BACKEND_URLS","headers","req","json","data","jobs","console","log","filterJobs","fetchInfo","method","ok","Error","message","Apply","name","email","age","number","experience","body","JSON","stringify","alert","fetchUser","users","applied","jobInfo","map","title","salary","location","type","description","appInfo","Math","random","filteredData","i","length","toLowerCase","props","includes","push","onFilter","background","search","inside","filter","inputs","e","target","value","isLoggedIn","buttons","cards","card2","sections","qualifications"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useCallback } from \"react\";\r\nimport { useParams } from 'react-router-dom';\r\nimport { Button, Modal } from 'react-bootstrap';\r\nimport { useContext } from \"react\"\r\nimport { AuthContext } from '../../shared/context/auth-context';\r\nimport { Link } from 'react-router-dom';\r\nimport classes from './StartingPageContent.module.css'\r\nimport Card from './Card'\r\nimport List from \"./List\";\r\n\r\n\r\n\r\n\r\nconst HomePage = () => {\r\n    const auth = useContext(AuthContext)\r\n    const [show, setShow] = useState(false);\r\n    const [job, setJob] = useState([])\r\n    const [info, setInfo] = useState([])\r\n    const [user, setUser] = useState([])\r\n    const [what, setWhat] = useState('')\r\n    const [app, setApp] = useState([])\r\n\r\n    const jobId = useParams().id;\r\n    const userId = auth.userId;\r\n\r\n    const handleClose = () => setShow(false);\r\n    const handleShow = () => setShow(true);\r\n\r\n\r\n    useEffect(() => {\r\n        const fetchjob = async () => {\r\n            try {\r\n                const req = await fetch(\r\n                    `${process.env.REACT_APP_BACKEND_URLS}/jobs`, {\r\n                    headers: {\r\n                        'Content-Type': 'application/json',\r\n                    }\r\n                }\r\n                )\r\n                const data = await req.json();\r\n                setJob(data.jobs)\r\n            } catch (err) {\r\n                console.log(err)\r\n            }\r\n        }\r\n        fetchjob();\r\n        filterJobs(what)\r\n    }, []);\r\n\r\n\r\n    useEffect(() => {\r\n        const fetchInfo = async () => {\r\n            try {\r\n                const req = await fetch(`${process.env.REACT_APP_BACKEND_URLS}/job/${jobId}`, {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Content-Type': 'application/json'\r\n                    }\r\n                });\r\n                const data = await req.json();\r\n                setInfo(data.job)\r\n                if (!req.ok) {\r\n                    throw new Error(req.message)\r\n                }\r\n            } catch (err) { }\r\n        }\r\n        fetchInfo()\r\n    }, [jobId]);\r\n\r\n\r\n    const Apply = useCallback(async () => {\r\n        let name = user.name\r\n        let email = user.email\r\n        let age = user.age\r\n        let number = user.number\r\n        let experience = user.experience\r\n        try {\r\n            const req = await fetch(`${process.env.REACT_APP_BACKEND_URLS}/job/${jobId}/apply`, {\r\n                method: 'POST',\r\n                headers: {\r\n                    'Content-Type': 'application/json'\r\n                },\r\n                body: JSON.stringify({\r\n                    name,\r\n                    email,\r\n                    age,\r\n                    number,\r\n                    experience\r\n                }),\r\n            })\r\n            if (req.ok) {\r\n                alert('successfully Applied, may take time to save')\r\n            }\r\n            if (!req.ok) {\r\n                alert('something went wrong or you already applied')\r\n                throw new Error(req.message)\r\n            }\r\n        } catch (err) { }\r\n    }, [jobId, user.age, user.email, user.experience, user.name, user.number])\r\n\r\n\r\n    useEffect(() => {\r\n        const fetchUser = async () => {\r\n            try {\r\n                const req = await fetch(`${process.env.REACT_APP_BACKEND_URLS}/user/${userId}`, {\r\n                    method: 'GET',\r\n                    headers: {\r\n                        'Content-Type': 'application/json'\r\n                    }\r\n                });\r\n                const data = await req.json();\r\n                setUser(data.users)\r\n                setApp(data.users.applied)\r\n\r\n                if (!req.ok) {\r\n                    throw new Error(req.message)\r\n                }\r\n            } catch (err) { }\r\n        }\r\n        fetchUser()\r\n    }, [userId, Apply]);\r\n\r\n    const jobInfo = job.map(job =>\r\n        <Card\r\n            key={job.id}\r\n            id={job.id}\r\n            title={job.title}\r\n            salary={job.salary}\r\n            location={job.location}\r\n            type={job.type}\r\n            description={job.description}\r\n        />)\r\n\r\n\r\n\r\n    const appInfo = app.map(({ title, salary, location }) => {\r\n        return <List\r\n            key={Math.random()}\r\n            title={title}\r\n            salary={salary}\r\n            location={location} />\r\n    })\r\n\r\n    const filterJobs = (what) => {\r\n        let filteredData = []\r\n        for (let i = 0; i < jobInfo.length; i++) {\r\n            what = what.toLowerCase()\r\n            const name = jobInfo[i].props.title.toLowerCase()\r\n\r\n            if (name.includes(what)) {\r\n                filteredData.push(jobInfo[i].props)\r\n                setJob(filteredData)\r\n            }\r\n        }\r\n    }\r\n\r\n\r\n    const onFilter = () => {\r\n        filterJobs(what)\r\n    }\r\n\r\n\r\n\r\n    return (\r\n        <section className={classes.background}>\r\n            <Modal show={show} onHide={handleClose}>\r\n                <Modal.Header closeButton>\r\n                    <Modal.Title>Applied To</Modal.Title>\r\n                </Modal.Header>\r\n                <Modal.Body>\r\n                    {appInfo || 'No jobs applied to'}\r\n                </Modal.Body>\r\n                <Modal.Footer>\r\n                    <Button variant=\"danger\" onClick={handleClose}>\r\n                        Close\r\n                    </Button>\r\n                </Modal.Footer>\r\n            </Modal>\r\n            <div className={classes.search}>\r\n                <form>\r\n                    <div className={classes.inside}>\r\n                        <div className={classes.filter}>\r\n                            <label htmlFor='what'>What</label>\r\n                            <input\r\n                                id='What'\r\n                                className={classes.inputs}\r\n                                value={what}\r\n                                onChange={(e) => setWhat(e.target.value)}\r\n                                placeholder='Job title or Keywords'\r\n                            />\r\n                        </div>\r\n                        <div>\r\n                            <Button onClick={onFilter}>Filter jobs</Button>\r\n                        </div>\r\n                    </div>\r\n                </form>\r\n            </div>\r\n            {auth.isLoggedIn && (\r\n                <div className={classes.buttons}>\r\n                    <Button onClick={handleShow}>My Jobs</Button>\r\n                </div>\r\n            )}\r\n            <div className={classes.cards}>\r\n                <div>\r\n                    {jobInfo}\r\n                </div>\r\n                <div className={classes.card2}>\r\n                    <div className={classes.sections}>\r\n                        <h3>{info.title || 'Select a job'}</h3>\r\n                        <h5>{info.location}</h5>\r\n                        {auth.isLoggedIn && (\r\n                            <Button onClick={Apply}>Apply Now</Button>\r\n                        )}\r\n                        {!auth.isLoggedIn && (\r\n                            <Link to='/auth'>\r\n                                <Button>Apply Now</Button>\r\n                            </Link>\r\n                        )}\r\n                    </div>\r\n                    <div className={classes.sections}>\r\n                        <h3>Job Details</h3>\r\n                        <h6>Salary</h6>\r\n                        <p>{info.salary || 'Searching...'}</p>\r\n                        <h6>Job Type</h6>\r\n                        <p>{info.type || 'Searching...'}</p>\r\n                    </div>\r\n                    <div className={classes.sections}>\r\n                        <h2>Qualifications</h2>\r\n                        <p>\r\n                            {info.qualifications || 'Searching...'}\r\n                        </p>\r\n                    </div>\r\n                    <div>\r\n                        <h2>Full Job Description</h2>\r\n                        <p>\r\n                            {info.description || 'Searching...'}\r\n                        </p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </section >\r\n    )\r\n\r\n}\r\n\r\nexport default HomePage"]},"metadata":{},"sourceType":"module"}